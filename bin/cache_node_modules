set -x
CACHE_PATH=/root/cache/yarn
CURRENT_PATH=${CACHE_PATH}/${DRONE_REPO_NAME}

if find ${CURRENT_PATH}/node_modules/ -mindepth 1 -print -quit 2>/dev/null | grep -q . ; then
	echo ">>>>>>Use cached data..."
	cp ${CURRENT_PATH}/node_modules . -rf
	eval "$@"
else
	mkdir -p ${CURRENT_PATH}
	eval "$@" && \
	echo ">>>>>>Copy data to cache..." && \
	cp node_modules ${CURRENT_PATH}/ -rf
fi

